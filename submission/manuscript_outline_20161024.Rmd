---
title: ''
csl: microbiome.csl
fontsize: 12pt
output:
  pdf_document:
    includes:
      in_header: header.tex
    keep_tex: yes
  html_document: default
geometry: margin=1.0in
bibliography: reference.bib
---

# Differences in the Stool Microbiome Before and After Colorectal Cancer Treatment


```{r knitr_settings, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}

source('../code/functions.R')
source('../code/graphFunctions.R')

loadLibs(c("dplyr", "ggplot2", "reshape2", "gridExtra", "scales", "wesanderson", "knitr", "rmarkdown"))

opts_chunk$set("tidy" = TRUE)
opts_chunk$set("echo" = FALSE)
opts_chunk$set("eval" = TRUE)
opts_chunk$set("warning" = FALSE)
opts_chunk$set("cache" = FALSE)
opts_chunk$set("message" = FALSE)

```


```{r rdata_tables}
# Extra data and meta data needed
good_metaf <- read.csv('../results/tables/mod_metadata/good_metaf_final.csv', header = T, stringsAsFactors = F)
metaI <- read.csv('../results/tables/mod_metadata/metaI_final.csv', header = T, stringsAsFactors = F)
total_sub_Seqs <- read.delim('../data/process/final.0.03.subsample.shared', header = T) %>% 
  select(contains("Otu0")) %>% rowSums()

# initial microbiome and FIT description data 
change_summary <- read.csv('../results/tables/change_theta_fit_summary.csv', header = T, row.names = 1)
alpha_summary <- read.csv('../results/tables/alpha_table_summary.csv', header = T, row.names = 1)
beta_summary <- read.csv('../results/tables/beta_diver_summary.csv', header = T, row.names = 1)
time_pvalues <- read.csv("../results/tables/time_pvalues.csv", header = T, row.names = 1)
all_OTU_pair_wilcox <- read.csv("../results/tables/OTU_paired_wilcoxson_test.csv", header = T)

# Main CRC bacteria differences between Adenoma and Carcinoma
main_crc_bugs_summary <- read.csv('../results/tables/adn_crc_maybe_pvalue_summary.csv', header = T, row.names = 1) 

# Lesion Model (Full)
lesion_top10_varsMDA <- read.csv('../results/tables/lesion_model_top_vars_MDA_Summary.csv', header = T)
lesion_imp_vars <- read.csv('../results/tables/rf_otu_tax.csv', header = T, row.names = 1)
lesion_AUC_run_summary <- read.csv('../results/tables/ROC_model_summary.csv', header = T)

# Lesion Model (Reduced)
reduced_lesion_AUC_run_summary <- read.csv('../results/tables/Reduced_ROC_model_summary.csv', header = T)

# IF Model (Full)
IF_top10_varsMDA <- read.csv('../results/tables/IF_model_top_vars_MDA_Summary.csv', header = T)
IF_imp_vars <- read.csv('../results/tables/if_rf_otu_tax.csv', header = T, row.names = 1)
IF_AUC_run_summary <- read.csv('../results/tables/IF_ROC_model_summary.csv', header = T)

# IF Model (Reduced)
reduced_IF_AUC_run_summary <- read.csv('../results/tables/reduced_IF_ROC_model_summary.csv', header = T)


# All model information
all_probs_paired_wilcox <- read.csv('../results/tables/all_models_wilcox_paired_pvalue_summary.csv', header = T, stringsAsFactors = F)
all_pred_stat_summary <- read.csv('../results/tables/all_models_summary_info.csv', header = T, stringsAsFactors = F)
all_confu_matrix <- read.csv('../results/tables/all_models_confusion_summary.csv', header = T, stringsAsFactors = F)

# Common Variable Info
common_vars_summary <- read.csv('../results/tables/pvalue_IF_lesion_common_imp_vars.csv', header = T, row.names = 1, stringsAsFactors = F)


```

\vspace{25mm}

\begin{center}
Running Title: Human Microbiome and Colorectal Cancer


\vspace{10mm}

Marc A Sze^1^, Nielson T Baxter^2^, Mack T Ruffin IV^3^, Mary AM Rogers^4^, and Patrick D Schloss^1^${^\dagger}$

\vspace{20mm}

$\dagger$ To whom correspondence should be addressed: pschloss@umich.edu

^1^Department of Microbiology and Immunology, University of Michigan, Ann Arbor, MI
^2^Department of Internal Medicine, Division of Infectious Disease, University of Michigan, Ann Arbor, MI
^3^Department of Family Medicine and Community Medicine, Penn State Hershey Medical Center, Hershey, PA
^4^Department of Internal Medicine, University of Michigan, Ann Arbor, MI
\end{center}


\newpage
\linenumbers

## Abstract

**Background:** Colorectal cancer (CRC) continues to be a worldwide health problem with early detection being used as a key component in mitigating deaths due to the disease. Previous research suggests a link between stool bacterial microbiome and CRC.   The overall objective was to investigate the changes in the bacterial microbiome after surgery in patients with lesion (i.e. adenoma or carcinoma).  Specifically, we wanted to identify what within the community was different within those undergoing surgical removal of lesion.  We also investigated the use of the bacterial microbiome and Fecal Immunoglobulin Test (FIT) to build models to either classify individuals as having a lesion or whether, based on the bacterial microbiome, the sample could be classified correctly as before or after surgery.   
**Results:** Adenoma individual's bacterial microbiome were more similar to their pre-surgery sample then those with carcinoma (P-value = `r format(change_summary['thetayc', 'Pvalue'], digits = 3)`) and this was also reflected in FIT as well (P-value = `r format(change_summary['fit', 'Pvalue'], scientific = TRUE, digits = 3)`).  There was no significant difference in any indivdiual OTU between samples before and after surgery (P > `r format(min(filter(all_OTU_pair_wilcox, analysis == "ALL")[, 'BH_corrected']), digits = 3)`.  A model with a total of `r length(lesion_top10_varsMDA$variable)` variables was able to classify lesion with an AUC range of `r format(max(reduced_lesion_AUC_run_summary$ROC), digits = 3)` to `r format(min(reduced_lesion_AUC_run_summary$ROC), digits = 3)` while the model to classify samples as before and after had `r length(IF_top10_varsMDA$variable)` with an AUC range of `format(max(reduced_IF_AUC_run_summary$ROC), digits = 3)` to `format(min(reduced_IF_AUC_run_summary$ROC), digits = 3)` for `r length(reduced_lesion_AUC_run_summary$ROC)` 20 repeated 10-fold cross-validated runs.  Both models had a significant decrease in the positive probability of a lesion between individual's before versus after surgery samples (P-value = `format(filter(all_probs_paired_wilcox, model_type == "red_lesion" & comparison =="lesion")[, "BH_correction"], scientific = TRUE, digits = 3)` and `format(filter(all_probs_paired_wilcox, model_type == "red_IF" & comparison =="lesion")[, "BH_correction"], scientific = TRUE, digits = 3)`).  In total there were `r length(common_vars_summary$otu)` OTUs that were common to both models and were mostly commensals with largest representation from OTUs belonging to `r common_vars_summary["Otu000005", "lowest_ID"]`, `r common_vars_summary["Otu000012", "lowest_ID"]`, `r common_vars_summary["Otu000082", "lowest_ID"]`, and 'r paste(gsub("_unclassified", "", common_vars_summary["Otu000006", "lowest_ID"]))`  
**Conclusions:** Our data suggests that treatment not only significantly reduces the probability of having a colonic lesion but also causes detectable changes in the bacterial microbiome.  Further surveillance of these individuals will enable us to determine whether models such as the one we present here can also be used to predict recurrence of colorectal cancer.  

\newpage

### Keywords

bacterial microbiome; colorectal cancer; polyps; FIT; detection; risk factors      

\newpage

## Background

Colorectal cancer (CRC) continues to be a leading cause of cancer related deaths and is the second most common cancer death among men aged 40-79 years of age [@jemal_cancer_2010; @haggar_colorectal_2009].  Over the last few years death due to the disease has seen a significant decrease, thanks mainly to improvements in screening [@jemal_cancer_2010].  However, despite this improvement there are still approximately 50,000 deaths from the disease a year [@haggar_colorectal_2009].  It is estimated that around 5-10% of all CRCs can be explained by autosomal dominant inheritance [@green_very_2007]. The vast majority of CRCs are not inherited and the exact etiology of the disease has not been well worked out [@haggar_colorectal_2009].  Although many risk factors have been identified [@haggar_colorectal_2009] and non-invasive screening techniques have started to be put into consistent use [@liao_application_2013; @johnson_multi-target_2016] there has been an consistent additional increase in the incidence of CRC in the younger population.  

This increased incidence of CRC in the younger population is concerning since having either an adenoma or carcinoma increases ones risk for future adenomas or carcinomas [@laiyemo_short-_2013; @matsuda_five-year_2009; @ren_long-term_2016].  This increased risk can also carry with it an increased chance of mortality due to this recurrence [@loberg_long-term_2014; @freeman_natural_2013].  Therefore there has been a great amount of interest in early risk stratification tools [@lee_identification_2016; @richards_evidence-based_2016] that can help identify those they may be at most susceptibility to reccurence.  Concurrently, there has also been a lot of interest in new areas that could have a role in disease pathogenesis, such as the gut bacterial microbiome.

There has been promising work on the bacterial microbiome and it's ability to be able to complement existing screening methods such as Fecal Immunoglobulin Test (FIT) or act alone as a screening tool [@baxter_microbiota-based_2016; @zeller_potential_2014]. There has also been research into how this microbiome could be altered directly on tumor tissue itself [@dejea_microbiota_2014].  A few studies have now even shown how this microbiome [@zackular_manipulation_2016] or specific members within it [@arthur_microbial_2014] could be directly involved with the pathogenesis of CRC.  These studies have helped to provide a tantilzing link between the bacterial microbiome and CRC. However, at this present time there remains limited information on the bacterial microbiome before and after successful surgery for removal of the adenoma or carcinoma and whether it changes at all.

In this study we investigated what happened to the bacterial microbiome before and after surgery for both adenoma and carcinoma individuals.  Our anlaysis includes both alpha and beta diversity analysis along with investigation of individual operational taxonomic units (OTUs).  We also utilized Random Forest models and observed how these models well as specific OTUs within this model performed on before (initial) and after (follow up) surgery samples.  We used these models to look for similar important OTUs to identify the most important ones for not only classifying initial and follow up samples but also lesion or normal.



\newpage

## Results

***Bacterial Community and Fit Changes before and after Treatment***
Based on thetayc distance metrics, comparing the initial to the follow up samples, there was no difference between the adenoma and carcinoma groups (P-value = `r format(change_summary['thetayc', 'Pvalue'], scientific = FALSE, digits = 3)`) [Figure 1a]. There was a difference in FIT between initial and follow up samples with the carcinoma group having a significant decrease in FIT versus the adenoma group (P-value = `r format(change_summary['fit', 'Pvalue'], scientific = TRUE, digits = 3)`) [Figure 1b].  Although the thetayc distance metric change was similar between adenoma and carcinoma the directionality of the change was significant in the cancer group between initial and follow up (P-value = `r format(beta_summary['Carcinoma', 'PERMANOVA'], scientific = FALSE, digits = 3)`) but not for the adenoma group (P-value = `r format(beta_summary['Adenoma', 'PERMANOVA'], scientific = FALSE, digits = 3)`).  This change can be visualized using an NMDS [Figure 1c & 1d]. When all follow up samples were compared to each other there was no significant overall difference between them (P-value = `r format(beta_summary['All', 'PERMANOVA'], scientific = FALSE, digits = 3)`).  There was no significant difference between initial and follow up samples for observed OTUs, Shannon diversity, or evenness after correction for multiple comparisons [Table S1].  Time of follow up sample from initial sampling, did not have a significant difference between adenoma and carcinoma (uncorrected P-value = `r format(time_pvalues["thetayc_change", "uncorrected_p_value"], digits = 3)`).    


***Outcome of Model Training***
The range of the AUC for model training ranged from a minimum of `r format(model_test_AUC_summary["worse", "ROC_cv"], digits = 3)` to a maximum of `r format(model_test_AUC_summary["best", "ROC_cv"], digits = 3)` with the middle of all `r length(rownames(model_train_summary))` runs having an AUC of `r format(model_test_AUC_summary["middle", "ROC_cv"], 
digits = 3)`.  Interestingly, the worst AUC model from training performed the best on it's respective 80/20 split test data [Figure 3].  In fact the 80/20 test performance showed that the AUC for the middle model chosen was the most stable (best training model test set AUC = `r format(model_test_AUC_summary["best", "AUC"], digits = 3)`, middle training model test set AUC = `r format(model_test_AUC_summary["middle", "AUC"], digits = 3)`, worse training model test set AUC = `r format(model_test_AUC_summary["worse", "AUC"], digits = 3)`).  That is to say it had the smallest change in AUC in comparison to the minimum and maximum AUC trained models.  The middle model was close to the full training data AUC `r format(model_test_AUC_summary["full", "AUC"], digits = 3)`. There was no significant difference between the AUC of the best and middle training models (P-value = `r format(roc_pvalues["best", "middle"], digits = 3)`).  There was also no difference in the middle model versus worse (P-value = `r format(roc_pvalues["middle", "worse"], digits = 3)`) or full data model (P-value = `r format(roc_pvalues["middle", "full"], digits = 3)`).  The two comparisons with a significant difference were between the worse training model and the best training model (P-value = `r format(roc_pvalues["best", "worse"], scientific = TRUE, digits = 3)`) and the worse training model and full training model (P-value = `r format(roc_pvalues["worse", "full"], scientific = TRUE, digits = 3)`).  


***Most Important Variables to the Model***
Overall, there were a total of `r format(length(rownames(imp_model_vars)))` variables identified as being present in more than 50% of the training models [Figure S2]. The top 5 most important bacterial OTUs were `r paste(rf_lowest_ID[1], " (", names(rf_lowest_ID)[1], ")", sep = "")`,  `r paste(rf_lowest_ID[2], " (", names(rf_lowest_ID)[2], ")", sep = "")`, `r paste(rf_lowest_ID[3], " (", names(rf_lowest_ID)[3], ")", sep = "")`, `r paste(rf_lowest_ID[4], " (", names(rf_lowest_ID)[4], ")", sep = "")`, and `r paste(rf_lowest_ID[5], " (", names(rf_lowest_ID)[5], ")", sep = "")`.  These 5 OTUs were present in at least `r min(filter(imp_model_vars, Variable %in% names(rf_lowest_ID)[1:5])[, "total_appearance"])` out of the total `r length(rownames(model_train_summary))` different 80/20 runs.


***Surgical Removal of an Adenoma or Carcinoma Results in a Decrease in Positive Probability Prediction***
A total of `r length(rownames(good_metaf)) - length(rownames(filter(good_metaf, !is.na(fit_followUp))))` sample was omitted from the original `r length(rownames(good_metaf))` test sample set since it was missing a complete set of follow up data.  This left a total of `r sum(initial_cm$ref_yes)` samples for test predictions.  After multiple comparison correction there was a significant overall decrease in positive probability of a carcinoma and adenoma (P-value = `r format(IF_model_wilcox_paired_summary["lesion", "BH_correction"], scientific = TRUE, digits = 3)`) [Figure 4].  This decrease was significant for both adenoma (P-value = `r format(IF_model_wilcox_paired_summary["all_adenoma", "BH_correction"], scientific = TRUE, digits = 3)` [Figure 4a] and carcinoma (P-value = `r format(IF_model_wilcox_paired_summary["carcinoma_only", "BH_correction"], scientific = TRUE, digits = 3)`) [Figure 4b] alone.  This decrease in probability of lesion also held specifically for those with screen relative neoplasias (SRN) (P-value = `r format(IF_model_wilcox_paired_summary["SRN_only", "BH_correction"], scientific = TRUE, digits = 3)`).  A total of `r initial_cm["pred_yes", "ref_yes"]` or `r format(confusion_summary["Accuracy", "initial"]*100, digits = 3)`% of all samples were correctly predicted to have a lesion.  Although there was a decrease in positive probability only `r followup_cm["pred_no", "ref_no"]` of the total `r sum(initial_cm$ref_yes)` individuals were classified as adenoma or carcinoma free on follow up (successful classification of `r format(confusion_summary["Accuracy", "followup"]*100, digits = 3)`%). There was no significant difference between the predictions and actual diagnosis for the initial samples in the `r length(rownames(good_metaf))`-sample cohort test set.  However, the predictions were significantly discordent with the diagnosis for the follow up samples (P-value = `r format(confusion_summary["McnemarPValue", "followup"], scientific = TRUE, digits = 3)`).  Although there were discordent results the respective sensitivity for the initial group was `r format(confusion_summary["Sensitivity", "initial"]*100, digits = 3)`% and for follow up was `r format(confusion_summary["Sensitivity", "followup"]*100, digits = 3)`%, respectively.

There was `r length(rownames(filter(good_metaf, Disease_Free == "n")))` individual who still clearly had CRC on follow up as well as `r length(rownames(filter(good_metaf, Disease_Free == "unknown")))` individuals whose status on follow up was unknown.  Although the `r length(rownames(filter(good_metaf, Disease_Free == "n")))` individual had a decrease in positive probability their follow up sample was still higher than the cutoff threshold of 0.5 (positive probability = `r format(filter(follow_up_prob_summary, sampleType == "followup" & disease_free == "n")[, "Yes"], digits = 3)`).  Interestingly, `r length(rownames(filter(follow_up_prob_summary, sampleType == "followup" & disease_free == "unknown" & Yes > 0.5)))` individuals who were unknown on follow up still were over the threshold cutoff of 0.5 even though, like the `r length(rownames(filter(good_metaf, Disease_Free == "n")))` individual with clear CRC on follow up, the probability of an adenoma or carcinoma decreased [Table S2]. 

The follow up positive probabilities were not affected by either chemotherapy treatment (uncorrected P-value = `r format(wilcox.test(filter(follow_up_prob_summary, sampleType == "followup", chemo == "yes")[, "Yes"], filter(follow_up_prob_summary, sampleType == "followup", chemo == "no")[, "Yes"])$p.value, digits = 3)`) or  radiation therapy (uncorrected P-value = `r format(wilcox.test(filter(follow_up_prob_summary, sampleType == "followup", rads == "yes")[, "Yes"], filter(follow_up_prob_summary, sampleType == "followup", rads == "no")[, "Yes"])$p.value, digits = 3)`).  There was also no difference in the amount of change in the positive probability based on whether individuals received chemotherapy (unccorected P-value = `r format(wilcox.test(filter(follow_up_prob_summary, sampleType == "initial", chemo == "yes")[, "Yes"] - filter(follow_up_prob_summary, sampleType == "followup", chemo == "yes")[, "Yes"], filter(follow_up_prob_summary, sampleType == "initial", chemo == "no")[, "Yes"] - filter(follow_up_prob_summary, sampleType == "followup", chemo == "no")[, "Yes"])$p.value, digits =3)`) or radiation therapy (uncorrected P-value = `r format(wilcox.test(filter(follow_up_prob_summary, sampleType == "initial", rads == "yes")[, "Yes"] - filter(follow_up_prob_summary, sampleType == "followup", rads == "yes")[, "Yes"], filter(follow_up_prob_summary, sampleType == "initial", rads == "no")[, "Yes"] - filter(follow_up_prob_summary, sampleType == "followup", rads == "no")[, "Yes"])$p.value, digits = 3)`).


***Specific OTUs in the Lesion Model are not Detected in Follow Up Versus Initial Samples*** 
Overall, there were a total of `r length(rownames(pvalue_common_imp_vars))` OTUs that were common between the main lesion model and the model for classifying initial and follow up samples specifically [Table S3].  A total of `r length(rownames(filter(pvalue_common_imp_vars, BH_corr < 0.05)))` OTU was still significant after multiple comparison correction and it's lowest taxonomic identification was to `r filter(pvalue_common_imp_vars, BH_corr < 0.05)[, "Genus"]`.  In general, `r filter(pvalue_common_imp_vars, BH_corr < 0.05)[, "otu"]` (`r filter(pvalue_common_imp_vars, BH_corr < 0.05)[, "Genus"]`) was decreased from initial to follow up [Figure 5].  The relative abundance was not drastically different then the mean of the values observed in the control training set [Figure 5].


***Differences in Adenoma and Carcinoma in Previously Associated Cancer Bacteria***
First, there was a clear magnitude difference in these specific OTUs based on whether they were from adenoma or carcinoma individuals [Figure 6].  The carcinoma samples showed a significant difference between initial and follow up samples for Peptostreptococcus stomatis (P-value = `r format(pvalue_adn_crc_summary["pept", "crc_BH"], digits = 3)`) and Porphyromonas asaccharolytica (P-value = `r format(pvalue_adn_crc_summary["porp", "crc_BH"], digits = 3)`) whereas there were no signficant differences in any of these OTUs in the adenoma samples [Table S4].



\newpage


## Discussion
In our training set we show that the overall community structure as measured by different alpha diversity metrics, shows very little change between controls and those with either adenoma or carcinoma [Table S1].  With respect to our test set there was very little difference in magnitude of change in the thetayc distance metric between those with adenoma or carcinoma [Figure 1a].  In contrast, FIT had a large change in the initial and follow up samples in the carcinoma group versus the adenoma [Figure 1b].  An NMDS showed that there was very little observable change between initial and follow up for the adenoma group but there was one for the carcinoma group [Figure 1c & 1d].  This cursory information is suggestive that treatment of carcinoma, had the largest response.

We next created a model that incorporated both patient metadata, FIT, and the bacterial microbiome to be able to predict lesions (adenoma or carcinoma).  Our middle training model, based on AUC, from 100 80/20 (train/test) splits was similar to the full training data model.  It's 10-fold cross validated AUC was similar to it's test set AUC which was not the case for both the best and worse training model [Figure 3].  Using the full training data model we predicted the probability of a lesion in the inital and follow up samples [Figure 4].  There was a signficant decrease in positive probability regardless of whether the sample was a carcinoma or adenoma.  The overall sensitivity for lesion detection in the intial samples was `r format(confusion_summary["Sensitivity", "initial"]*100, digits = 3)` and for follow ups was `r format(confusion_summary["Sensitivity", "followup"]*100, digits = 3)`.  Although there was a decrease in overall probability of an adenoma or carcinoma only `r followup_cm["pred_no", "ref_no"]` were below the 0.5 threshold out of the total `r sum(followup_cm$ref_no)` individuals who were diagnosed as not having a carcinoma on follow up.  

We then investigated which OTUs could potentially be more important in our model [Figure 5 & Table S3].  Many of the OTUs identified classified to normal flora bacterium [Table S3].  Only a single OTU though was significant after multiple comparison correction and the lowest taxonomic identification of `r filter(pvalue_common_imp_vars, BH_corr < 0.05)[, "otu"]` was to `r filter(pvalue_common_imp_vars, BH_corr < 0.05)[, "Genus"]`. Although there was a difference in the relative abundance at initial and follow up these values were not drastically different from the relative abundance values observed in the control individuals of the training set [Figure 5].  Although we were interested in what we could use to classify those with either adenoma or carcinoma versus normal.  We found that the traditional bacteria associated with CRC were higher in magnitude in the carcinoma group and there were significant differences in some of these OTUs between the initial and follow up samples [Figure 5 and Tabl S5].  This research provides evidence that it is possible to use bacterial microbiome data to create a highily sensitive model, that is reactive to therapy, for detection of adenoma or carcinoma.  It accomplishes this by using a unique sample set in which before and after surgery stool samples are available for assessment.  By using these types of samples we are not only able to show sensitivity of lesion prediction but also able to show that this model is reactive.  That is to say that after surgery for removal of the adenoma or carcinoma it decreases the positive probability to reflect a lower likelihood of the individual having an adenoma or carcinoma.

This study builds upon previous work from numerous labs that have looked into the bacterial microbiome as a potential screening tool (**insert citation**).  Based on previous work by Jobin, et al. (**insert citation**)  it may not be surprising to see E.coli in the top 5 OTUs for this model.  Similarily, Porphyromonas has also been implicated in colorectal cancer (**insert citation**).  Interestingly, many of the other OTUs had taxonomic identification for resident gut microbes.  This could suggest that changes to the resident microbiome are important to the initiation of adenoma or carcinoma formation (**insert citation**) and provide support for the hypothesis that an initial change in the bacterial microbiome could pave the way for more inflammatory species: whether by creation of a new niche for oral microbes (**insert citation**) or allowing for a bloom of existing pro-inflammatory residents (**insert citation**).

Naturally, it is curious that normal staples of many screening studies such as Fusobacterium, Parvimonas, and Peptostreptococcus were not present in the majority of the training models.  One potential explanation for this is that FIT provides the same information to the model as these three organisms and so the model uses FIT preferentially over them.  This has been suggested to be the case in a previous study (**insert Baxter Study**).  It is also possible that these specific bacteria play a major role in the progression to carcinoma but may not be as important in the initiation of an adenoma, which would be supported by our data [Figure 5].  Regardless, our study does not argue against the importance of these bacterium in CRC initiation or pathogenesis but rather that the model does not utilize these specific bacteria for prediction purposes.  Another potential reason why we did not identify the "usual suspects"" is that these bacteria may not change much between initial and follow up samples in those with an identified lesion.  That is to say that the bacteria are consistently present even after removal of the lesion by surgery.  Finally, it is likely that within our test set there was not enough indviduals in which detection  was made or relative abundance high enough for these bacteria to be significant using a paired wilcoxson test.   

One limitation in this study is that we do not know whether individuals in our test set eventually had a subsequent CRC diagnosis.  This information would help to strengthen the case for our Random Forest based model keeping a number of individuals above the cutoff threshold even though at follow up they were diagnosed as no longer having a lesion.  Another limitation is that we do not know if adding modern tests such as the stool DNA test (**insert citation**) could help improve our overall AUC.  Another limitation is that this study drew heavily from those with caucasian ancestry.  The results may not be immediately representative of those with either Asian or African ancestry.  Finally, although our training and test set are relatively large we still run the risk of overfitting or having a model that may not be immediately extrapolateable to other populations.  We've done our best to safeguard against this by not only running 10-fold cross validation but also having over 100 different 80/20 splits to try and mimic the type of variation that might be expected to occur.

By adding patient data such as age, BMI, etc. to the model and showing that it can successfully help to predict both carcinoma and adenoma our study provides further data that these patient factors in conjunction with the bacterial microbiome could potentially influence CRC and perhaps have a role in formation of adenomas.  Further studies need to be carried out to verify our findings since not only are we dealing with stool, which could be very different than the communities present on the actual tissue, but also are dealing with correlations that may not be representative of the true pathogensis of disease.

Despite these limitations we think that these findings significantly add to the existing scientific knowledge on CRC and the bacterial microbiome.  The ability for machine learning algorithms to take bacterial microbiome data and successfully lower positive probability after either adenoma or carcinoma removal provides evidence that there are specific signatures associated with these lesions.  It also shows that these algorithms can not only successfully react to successful treatment regimens but also may be able to one day diagnose CRC with a high level of accuracy.



\newpage

## Methods

***Study Design and Patient Sampling***
The sampling and design of the study was similar to that reported in Baxter, et al [@baxter_microbiota-based_2016].  In brief, study exclusion involved those who had already undergone surgery, radiation, or chemotherapy, had colorectal cancer before a baseline stool sample could be obtained, had IBD, a known hereditary non-polyposis colorectal cancer, or Familial adenomatous polyposis.  Samples used to build the model used for prediction were collected either prior to a colonoscopy or between 1 - 2 weeks after.  The bacterial microbiome has been shown to nomralize within this time period [@obrien_impact_2013].  Kept apart from this training set were a total of `r length(rownames(good_metaf))` individuals that not only had a sample as described previoulsy but also a follow up sample between `r min(good_metaf$time)` - `r max(good_metaf$time)` days after surgery and treatment had been completed. This study was approved by the University of Michigan Institutional Review Board.  All study participants provided informed consent and the study itself conformed to the guidelines set out by the Helsinki Declaration.


***Fecal Immunochemical Test and 16S rRNA Gene Sequencing***
FIT was analyzed as previously published using both OC FIT-CHEK and OC-Auto Micro 80 automated system (Polymedco Inc.) [@daly_evaluation_2013]. 16S rRNA gene sequencing was completed as previously described by Kozich, et al. [@kozich_development_2013].  In brief, DNA extraction used the 96 well Soil DNA isolation kit (MO BIO Laboratories) and an epMotion 5075 automated pipetting system (Eppendorf).  The V4 variable region was amplified and the resulting product was split between three sequencing runs with control, adenoma, and carcinoma evenly represented on each run.  Each group was randomly assigned to avoid biases based on sample collection location.


***Sequence Processing***
The mothur software package (v1.37.5) was used to process the 16S rRNA gene sequences.  This process has been previously described [@kozich_development_2013].  The general processing workflow using mothur is as follows: Paired-end reads were first merged into contigs, quality filtered, aligned to the SILVA database, screening for chimeras, classified with a naive Bayesian classifier using the Ribosomal Database Project (RDP), and clustered into Operational Taxonomic Units (OTUs) using a 97% similarity cutoff with an average neighbor clustering algorithm.  The numer of sequences for each sample was rarified to `r ifelse(sd(total_sub_Seqs) == 0, paste(mean(total_sub_Seqs)), paste("Error Check Subsampling"))` in an attempt to minimize uneven sampling.    


***Lesion Model Creation***
The Random Forest [@breiman_random_2001] algorithm was used to create the model used for prediction of lesion (adenoma or carcinoma) for the `r length(rownames(good_metaf))` individuals with follow up samples.  The model included data on FIT and the bacterial microbiome. Non-binary data was checked for near zero variance and auto correlation.  Data columns that had near zero variance were removed.  Columns that were correlated with each other over a Spearman correlation coefficient of 0.75 had one of the two columns removed.  This pre-processing was performed with the R package caret (v`r paste(packageVersion("caret"))`).  Optimization of the mtry hyperparameter involved taking the samples and making 100 80/20 (train/test) splits in the data where control and lesion were equally represented in the 80 and 20 split, respectively.  This 80% portion was then split again into an 80/20 split, and run through 20 repeated 10-fold cross validations to optimzie the model's AUC (Area Under the Curve of the Receiver Operator Characteristic).  This resulting model was then tested on the 20% of the data that was originally held out from this overall process.  Once the ideal mtry was found the entire `r length(rownames(metaI))` sample set was used to create the final Random Forest model on which testing on the `r length(rownames(good_metaf))`-person cohort was completed.  The default cutoff of 0.5 was used as the threshold to classify individuals as positive or negative for lesion.  The hyperparameter, mtry, defines the number of variables to investigate at each split before a new division of the data is created.  


***Initial Follow Up Model Creation***
We also investigated whether a model could be created that could identify before and after surgery samples.  The training set utilized the `r length(rownames(good_metaf))`-person cohort that was previously used for testing of the lesion modeld.  The creation of this model and optimization of the mtry hyperparameter was completed using the same procedure that was used to create the lesion model. 


***Selection of Important OTUs***
In order to assess which variables were most central to all the models we counted the number of times a variable was present in the top 10% of mean decrease in accuracy (MDA) for each different 80/20 split model and then filtered this list to variables that were only present more than 50% of the time.  This final collated list of variables was what was considered the most important for the lesion or initial follow up models.


***Statistical Analysis***
The R software package (v`r paste(version$major, ".", version$minor, sep = "")`) was used for all statisitical analysis.  Comparisons between bacterial community structure utilized PERMANOVA [@anderson_permanova_2013] in the vegan package (v`r paste(packageVersion("vegan"))`) while comparisons between ROC curves utilized the method by DeLong et al. [@delong_comparing_1988] executed by the pROC (v`r paste(packageVersion("pROC"))`) package.  Comparisons between probabilities as well as overall amount of OTU between initial and follow up samples utilized a paired wilcoxson ranked sum test.  Where multiple comparison testing was needed a Benjamini-Hochberg (BH) correction was applied [@benjamini_controlling_1995] and a corrected P-value of less than 0.05 was considered significant.  Unless otherwise stated the P-values reported are those of the BH corrected ones.  


***Analysis Overview***
Differences in FIT between initial and follow ups for either adenoma or carcinoma were investigated.  Next, initial and follow up samples were analyzed for differences in alpha and beta diversity.  All OTUs used in the lesion model were also analyzed using a paired wilcoxson test.  The lesion model was then tested for accuracy in prediction and whether it reduced the positive probability of lesion after surgery.  The most important OTUs for this were used to build an updated model and this reduced feature model was assessed for it's similarity to the original model.  We then used the initial follow up model to assess whether this model could classify samples better then the lesion model.  The most important OTUs were then identified from this model and used to create a reduced feature initial follow up model.  This reduced feature model, as was done with the lesion model, was compared to the full model for loss of accuracy.  Finally, in order to investigate the relative abundance of specific bacteria, that have been previously associated with CRC, we selected OTUs that taxonomically classified to Fusobacterium Nucleatum, Parvimonas Micra, Peptostreptococcus Assacharolytica, and Porphyromonas Stomatis.  Specifically, we wanted to test if there were any differences based on whether the individual had an adenoma or carcinoma.  


***Reproducible methods.***
A detailed and reproducible description of how the data were processed and analyzed can be found at https://github.com/SchlossLab/Sze_followUps_2017.


\newpage


**Figure 1: Changes and differences between the adenoma or carcinoma group.**  A) No significant difference was found between the adenoma and carcinoma group for thetayc (P-value = `r format(change_summary['thetayc', 'Pvalue'], scientific = FALSE, digits = 3)`).  B) A significant difference was found between the adenoma and carcinoma group for FIT (P-value = `r format(change_summary['fit', 'Pvalue'], scientific = TRUE, digits = 3)`). C) NMDS of the intial and follow up samples for the Adenoma group.  D) NMDS of the initial and follow up samples for the Carcinoma group. For C) and D) the teal represents initial samples and the pink represents follow up samples. 


**Figure 2: Previously Associated CRC Bacteria in Initial and Follow up Samples.**  A) Carcinoma initial and follow up samples. There was a significant difference in initial and follow up sample for the OTUs classfied as Peptostreptococcus stomatis (P-value = `r format(pvalue_adn_crc_summary["pept", "crc_BH"], digits = 3)`) and Porphyromonas asaccharolytica (P-value = `r format(pvalue_adn_crc_summary["porp", "crc_BH"], digits = 3)`).  B) Adenoma initial and follow up samples.  There were no significant differences between initial and follow up.


**Figure 3: Graph of the Receiver Operating Characteristic Curve for lesion and Initial/Follow up models.** The shaded areas represents the range of values of a 100 different 80/20 splits of the test set data using either all variables (grey) or reduced variable (red) models.  The blue line represents the reduced variable model using 100% of the data set.  A) Lesion model.  B) Initial/Follow up model


**Figure 4: Breakdown by Carcinoma and Adenoma of Prediction Results for Lesion and Initial and Follow Up for Reduced Variable Models**  A) Positive probability adjustment of those with carcinoma from intial to follow up sample  B) Positive probability adjustment of those with adenoma as well as those with SRN and the probability adjustment from initial to follow up sample.  The dotted line represents the threshold used to make the decision of whether a sample was lesion positive or not.


\newpage

**Figure S1: Distribution of P-values from Paired Wilcoxson Analysis of OTUs in Initial versus Follow Up**

**Figure S2: Summary of Important Variables in the Lesion Model** A) MDA of the most important variables in the lesion model.  The black point represents the median and the different colors are the different runs up to 100.  B) The total number of appearances of each variable in the 100 different lesion models.  The cutoff of 50% was used to assess importance. 

**Figure S3: Summary of Important Variables in Initial Follow Up Model** A) MDA of the most important variables in the lesion model.  The black point represents the median and the different colors are the different runs up to 100.  B) The total number of appearances of each variable in the 100 different lesion models.  The cutoff of 50% was used to assess importance. 

**Figure S4: Breakdown by Carcinoma and Adenoma of Prediction Results for Lesion and Initial and Follow Up for Full Variable Model** A) Positive probability adjustment of those with carcinoma from intial to follow up sample  B) Positive probability adjustment of those with adenoma as well as those with SRN and the probability adjustment from initial to follow up sample.  The dotted line represents the threshold used to make the decision of whether a sample was lesion positive or not.

**Figure S5: Thetayc Graphed Against Time of Follow up Sample from Initial**

\newpage

## Declarations

### Ethics approval and consent to participate

### Consent for publication

### Availability of data and material

### Competing Interests

All authors declare that they do not have any relevent competing interests to report.

### Funding

This study was supported by funding from the National Institutes of Health to P. Schloss (R01GM099514, P30DK034933) and to the Early Detection Research Network (U01CA86400).

### Authors' contributions

All authors were involved in the conception and design of the study. MAS analyzed the data. NTB processed samples and analyzed the data. All authors interpreted the data. MAS and PDS wrote the manuscript. All authors reviewed and revised the manuscript. All authors read and approved the final manuscript.

### Acknowledgements

The authors thank the Great Lakes-New England Early Detection Research Network for providing the fecal samples that were used in this study. 

\newpage

## References




